export JAVA_HOME=/data/apps/jdk1.7.0
export JDK_HOME=$JAVA_HOME
export PATH=$JAVA_HOME/bin:$PATH


HOST=horstmann@cs12.cs.sjsu.edu
DOMAIN=/opt/glassfish4/glassfish/domains/domain1
CODECHECK_HOME=/opt/codecheck

BASENAME=`pwd`/`dirname $0`
cd $BASENAME

cd ../../server
ant war

cd $BASENAME
jar uf ../../server/antbuild/codecheck.war WEB-INF/web.xml

cd ../../server/antbuild
rsync -e "ssh -p 62222" codecheck.war $HOST:$DOMAIN/autodeploy

cd $BASENAME
cp ../s3.properties .
rsync -e "ssh -p 62222" codecheck codecheck.policy s3.properties $HOST:$CODECHECK_HOME
rm s3.properties

cd ../../checker
ant clean
ant
rsync -e "ssh -p 62222" codecheck.jar horstmanncomodo.jks lib $HOST:$CODECHECK_HOME


